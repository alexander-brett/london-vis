D:\vis\data>perl -n -F',' -mJSON -e "BEGIN{%result={}};$count=$result{$F[32]}{count}++;if($count == 0){$result{$F[32]}{lat}=$F[-2]; $result{$F[32]}{long}=$F[-1];}else{$result{$F[32]}{lat}-=($result{$F[32]}{lat}-$F[-2])/$count;$result{$F[32]}{long}-=($result{$F[32]}{long}-$F[-1])/$count};END{print JSON->new->encode(\%result)};"  ..\London_postcode-ONS-postcode-Directory-May15.csv > wardCentres.json